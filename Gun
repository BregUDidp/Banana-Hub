game.StarterGui:SetCore("SendNotification", {
    Title = "[ ‡πÄ‡∏õ‡∏¥‡∏î ‡∏õ‡∏∑‡∏ô‡∏™‡∏µ‡∏£‡∏∏‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß üî´  ]",
    Text = "________________________________________________________",
    Duration = 10
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local character = player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- Variables
local currentGun = nil
local highlight = nil
local hue = 0
local connections = {}

-- Function ‡∏™‡∏£‡πâ‡∏≤‡∏á Highlight
local function createHighlight(tool)
    if highlight then
        highlight:Destroy()
    end
    
    highlight = Instance.new("Highlight")
    highlight.FillColor = Color3.fromHSV(0, 1, 1)
    highlight.OutlineColor = Color3.fromHSV(0, 1, 1)
    highlight.FillTransparency = 0.3
    highlight.OutlineTransparency = 0
    highlight.Parent = tool:FindFirstChild("Handle") or tool
    highlight.Adornee = tool:FindFirstChild("Handle") or tool
end

-- Rainbow Effect Loop
local function updateRainbow()
    if currentGun and highlight then
        hue = (hue + 0.01) % 1
        local color = Color3.fromHSV(hue, 1, 1)
        highlight.FillColor = color
        highlight.OutlineColor = color
        
        -- Set ‡∏™‡∏µ‡∏ó‡∏∏‡∏Å Part ‡πÉ‡∏ô‡∏õ‡∏∑‡∏ô
        for _, part in pairs(currentGun:GetDescendants()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Color = color
            end
        end
    end
end

-- Detect Gun Equip/Unequip
local function onChildAdded(child)
    if child:IsA("Tool") then
        child.Equipped:Connect(function()
            currentGun = child
            wait(0.1) -- ‡∏£‡∏≠ tool ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
            createHighlight(child)
        end)
        
        child.Unequipped:Connect(function()
            if currentGun == child then
                currentGun = nil
                if highlight then
                    highlight:Destroy()
                    highlight = nil
                end
            end
        end)
    end
end

-- Character Respawn Handler
local function onCharacterAdded(newChar)
    character = newChar
    humanoid = character:WaitForChild("Humanoid")
    rootPart = character:WaitForChild("HumanoidRootPart")
    currentGun = nil
    if highlight then
        highlight:Destroy()
        highlight = nil
    end
    
    for _, conn in pairs(connections) do
        conn:Disconnect()
    end
    connections = {}
    
    -- Detect tools ‡πÉ‡∏ô Backpack/Character
    for _, child in pairs(character:GetChildren()) do
        onChildAdded(child)
    end
    connections[#connections + 1] = character.ChildAdded:Connect(onChildAdded)
    
    -- Detect ‡πÉ‡∏ô Backpack
    local backpack = player:WaitForChild("Backpack")
    for _, child in pairs(backpack:GetChildren()) do
        onChildAdded(child)
    end
    connections[#connections + 1] = backpack.ChildAdded:Connect(onChildAdded)
end

-- Start
onCharacterAdded(character)
player.CharacterAdded:Connect(onCharacterAdded)

-- Rainbow Loop (60 FPS smooth)
RunService.Heartbeat:Connect(updateRainbow)

print("üåà Rainbow Gun Highlight LOADED! (FPS Flick Ready)")
