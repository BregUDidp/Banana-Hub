--// ============================================== --
--//          AIMBOT + ESP + RAINBOW TOOL HUB      --
--// ============================================== --

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Notification
game.StarterGui:SetCore("SendNotification", {
    Title = "[ Aimbot Function ]",
    Text = "________________________________________________________",
    Duration = 10
})

--// Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

--// Rayfield Window
local Window = Rayfield:CreateWindow({
    Name = "   |  Aimbot  |  Akari  [ V-8.2 ]",
    Icon = "scan-eye",
    LoadingTitle = "|  üéØ  |  Aimbot   Function ",
    LoadingSubtitle = string.rep("_", 150),
    ShowText = "Aimbot",
    Theme = "DarkBlue",
    ToggleUIKeybind = "F",
    DisableRayfieldPrompts = true,
    DisableBuildWarnings = true,
    ConfigurationSaving = { Enabled = true, FolderName = nil, FileName = "Big Hub" },
    KeySystem = false
})

--// Tabs
local AimbotTab = Window:CreateTab("Aimbot  [ 1Ô∏è‚É£ ]", "crosshair")
local RainbowTab = Window:CreateTab("Rainbow Gun  [ üî´ ]", "rainbow")

--// ============================================== --
--//               AIMBOT SETTINGS                 --
--// ============================================== --

local plrs = game:GetService("Players")
local plr = plrs.LocalPlayer
local cam = workspace.CurrentCamera
local input = game:GetService("UserInputService")
local run = game:GetService("RunService")
local screenSize = cam.ViewportSize

-- Settings
local target = nil
local fovRadius = 120
local showFov = false  -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏¥‡∏î
local smoothness = 0.12
local prediction = 0.135
local rainbowSpeed = 3
local rainbowHue = 0

-- Drawing Objects
local fovCircle = nil
local lockLine = nil
local targetName = nil
local hpText = nil

-- Rainbow Function
local function getRainbow()
    rainbowHue = (rainbowHue + (rainbowSpeed / 1000)) % 1
    return Color3.fromHSV(rainbowHue, 1, 1)
end

-- Create FOV Circle
local function createFovCircle()
    if fovCircle then fovCircle:Remove() end
    local c = Drawing.new("Circle")
    c.Thickness = 3
    c.Filled = false
    c.Transparency = 1
    c.NumSides = 80
    c.Position = Vector2.new(screenSize.X / 2, screenSize.Y / 2)
    return c
end

-- Create Lock Line
local function createLockLine()
    if lockLine then lockLine:Remove() end
    local l = Drawing.new("Line")
    l.Thickness = 3
    l.Transparency = 1
    return l
end

-- Create Target Name
local function createTargetName()
    if targetName then targetName:Remove() end
    local t = Drawing.new("Text")
    t.Size = 18
    t.Center = true
    t.Outline = true
    t.Font = 2
    return t
end

-- Create HP Text
local function createHpText()
    if hpText then hpText:Remove() end
    local t = Drawing.new("Text")
    t.Size = 16
    t.Center = true
    t.Outline = true
    t.Font = 2
    return t
end

-- Initialize
fovCircle = createFovCircle()
lockLine = createLockLine()
targetName = createTargetName()
hpText = createHpText()

-- Get Closest in FOV
local function GetClosestInFOV()
    local closest = nil
    local dist = math.huge
    local center = Vector2.new(screenSize.X / 2, screenSize.Y / 2)

    for _, v in pairs(plrs:GetPlayers()) do
        if v ~= plr and v.Character and v.Character:FindFirstChild("Head") and v.Character:FindFirstChild("Humanoid") and v.Character.Humanoid.Health > 0 then
            local head = v.Character.Head
            local pos, onScreen = cam:WorldToViewportPoint(head.Position)
            if onScreen then
                local screenPos = Vector2.new(pos.X, pos.Y)
                local mag = (screenPos - center).Magnitude
                if mag <= fovRadius and mag < dist then
                    dist = mag
                    closest = v
                end
            end
        end
    end
    return closest
end

-- Predict Position
local function getPredictedPosition(head)
    local root = head.Parent:FindFirstChild("HumanoidRootPart")
    if root then
        local v = root.Velocity
        local d = (cam.CFrame.Position - head.Position).Magnitude
        return head.Position + (v * d * prediction / 100)
    end
    return head.Position
end

-- Main Loop
run.RenderStepped:Connect(function()
    local rainbow = getRainbow()
    local center = Vector2.new(screenSize.X / 2, screenSize.Y / 2)

    -- FOV Circle + Aimbot Control
    if showFov then
        fovCircle.Position = center
        fovCircle.Radius = fovRadius
        fovCircle.Color = rainbow
        fovCircle.Visible = true

        -- Aimbot ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ FOV ‡πÄ‡∏õ‡∏¥‡∏î
        target = GetClosestInFOV()
        if target and target.Character and target.Character:FindFirstChild("Head") and target.Character:FindFirstChild("Humanoid") then
            local head = target.Character.Head
            local hum = target.Character.Humanoid
            local pred = getPredictedPosition(head)
            local targetCF = CFrame.new(cam.CFrame.Position, pred)
            cam.CFrame = cam.CFrame:Lerp(targetCF, smoothness)

            -- Lock Line
            local headPos = cam:WorldToViewportPoint(pred)
            lockLine.From = center
            lockLine.To = Vector2.new(headPos.X, headPos.Y)
            lockLine.Color = rainbow
            lockLine.Visible = true

            -- Target Name
            targetName.Text = target.DisplayName
            targetName.Position = Vector2.new(headPos.X, headPos.Y - 40)
            targetName.Color = rainbow
            targetName.Visible = true

            -- HP in FOV
            local hpPercent = math.floor((hum.Health / hum.MaxHealth) * 100)
            hpText.Text = hum.Health .. "/" .. hum.MaxHealth .. " (" .. hpPercent .. "%)"
            hpText.Position = center
            hpText.Color = rainbow
            hpText.Visible = true

            fovCircle.Thickness = 4  -- ‡∏´‡∏ô‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Ñ
        else
            lockLine.Visible = false
            targetName.Visible = false
            hpText.Visible = false
            fovCircle.Thickness = 3
        end
    else
        -- ‡∏õ‡∏¥‡∏î FOV = ‡∏õ‡∏¥‡∏î Aimbot
        fovCircle.Visible = false
        lockLine.Visible = false
        targetName.Visible = false
        hpText.Visible = false
        target = nil
    end
end)

-- GUI: ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° FOV ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î Aimbot
AimbotTab:CreateToggle({
    Name = "[ üéØ ]  ‡∏õ‡∏¥‡∏î/‡πÄ‡∏õ‡∏¥‡∏î ‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏õ‡πã‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏∑‡πà‡∏ô‡πÜ  [ üéØ ]",
    CurrentState = false,
    Callback = function(v) 
        showFov = v
    end
})

AimbotTab:CreateSlider({
    Name = "[ üìè ]  ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°  [ üìè ]",
    Range = {50, 300}, Increment = 5, CurrentValue = 120,
    Callback = function(v) fovRadius = v end
})

AimbotTab:CreateSlider({
    Name = "[ ‚ö° ]  ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏õ‡πà‡∏≤  [ ‚ö° ]",
    Range = {1, 30}, Increment = 1, CurrentValue = 12,
    Callback = function(v) smoothness = v / 100 end
})

--// ============================================== --
--//                   ESP SYSTEM                  --
--// ============================================== --
local ESP = {
    Enabled = false,
    Tracer = true,
    Boxes = {},
    RainbowSpeed = 1
}

local function Rainbow(t, offset)
    return Color3.fromHSV((tick() * ESP.RainbowSpeed + (offset or 0)) % 1, 1, 1)
end

local function CreateESP(player)
    if ESP.Boxes[player] then return end
    local box = {}
    box.Square = Drawing.new("Square")
    box.Square.Thickness = 2
    box.Square.Filled = false
    box.Square.Visible = false

    box.Name = Drawing.new("Text")
    box.Name.Size = 16
    box.Name.Center = true
    box.Name.Outline = true
    box.Name.Visible = false

    box.Tracer = Drawing.new("Line")
    box.Tracer.Thickness = 2
    box.Tracer.Visible = false

    ESP.Boxes[player] = box
end

local function RemoveESP(player)
    local box = ESP.Boxes[player]
    if box then
        for _, v in pairs(box) do pcall(v.Remove, v) end
        ESP.Boxes[player] = nil
    end
end

--// ESP Loop
RunService.RenderStepped:Connect(function()
    if not ESP.Enabled then
        for p, _ in pairs(ESP.Boxes) do RemoveESP(p) end
        return
    end

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local hum = player.Character:FindFirstChild("Humanoid")
            if hum and hum.Health > 0 then
                CreateESP(player)
                local box = ESP.Boxes[player]
                local root = player.Character.HumanoidRootPart
                local pos, onScreen = Camera:WorldToViewportPoint(root.Position)

                if onScreen then
                    local scale = math.clamp(2000 / (Camera.CFrame.Position - root.Position).Magnitude, 20, 200)
                    local size = Vector2.new(scale * 0.6, scale)
                    local center = Vector2.new(pos.X, pos.Y)

                    -- Box
                    box.Square.Size = size
                    box.Square.Position = center - size/2
                    box.Square.Color = Rainbow(1, 0)
                    box.Square.Visible = true

                    -- Name
                    box.Name.Position = center + Vector2.new(0, -size.Y/2 - 18)
                    box.Name.Text = player.Name
                    box.Name.Color = Rainbow(1, 0.15)
                    box.Name.Visible = true

                    -- Tracer
                    if ESP.Tracer then
                        local screenCenter = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
                        box.Tracer.From = screenCenter
                        box.Tracer.To = center
                        box.Tracer.Color = Rainbow(1, 0.25)
                        box.Tracer.Visible = true
                    end
                else
                    box.Square.Visible = false
                    box.Name.Visible = false
                    box.Tracer.Visible = false
                end
            else
                RemoveESP(player)
            end
        else
            RemoveESP(player)
        end
    end
end)

Players.PlayerRemoving:Connect(RemoveESP)

--// ============================================== --
--//              RAINBOW GUN SYSTEM               --
--// ============================================== --
local RainbowGun = {
    Enabled = false,
    Current = nil,
    Highlight = nil,
    Hue = 0,
    Connections = {},
    Loop = nil
}

local function CreateHighlight(tool)
    if RainbowGun.Highlight then RainbowGun.Highlight:Destroy() end
    RainbowGun.Highlight = Instance.new("Highlight")
    RainbowGun.Highlight.FillTransparency = 0.3
    RainbowGun.Highlight.OutlineTransparency = 0
    RainbowGun.Highlight.Parent = tool
    RainbowGun.Highlight.Adornee = tool:FindFirstChild("Handle") or tool
end

local function UpdateRainbowGun()
    if not RainbowGun.Enabled or not RainbowGun.Current or not RainbowGun.Highlight then return end
    RainbowGun.Hue = (RainbowGun.Hue + 0.01) % 1
    local color = Color3.fromHSV(RainbowGun.Hue, 1, 1)
    RainbowGun.Highlight.FillColor = color
    RainbowGun.Highlight.OutlineColor = color
    for _, part in pairs(RainbowGun.Current:GetDescendants()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            part.Color = color
        end
    end
end

local function OnEquipped(tool)
    if not RainbowGun.Enabled then return end
    RainbowGun.Current = tool
    task.wait(0.1)
    CreateHighlight(tool)
end

local function OnUnequipped()
    if RainbowGun.Highlight then RainbowGun.Highlight:Destroy() RainbowGun.Highlight = nil end
    RainbowGun.Current = nil
end

local function SetupGun(char)
    for _, c in pairs(RainbowGun.Connections) do c:Disconnect() end
    RainbowGun.Connections = {}

    local function ConnectTool(tool)
        table.insert(RainbowGun.Connections, tool.Equipped:Connect(function() OnEquipped(tool) end))
        table.insert(RainbowGun.Connections, tool.Unequipped:Connect(OnUnequipped))
    end

    for _, child in pairs(char:GetChildren()) do
        if child:IsA("Tool") then ConnectTool(child) end
    end
    table.insert(RainbowGun.Connections, char.ChildAdded:Connect(function(c)
        if c:IsA("Tool") then ConnectTool(c) end
    end))

    local backpack = LocalPlayer:WaitForChild("Backpack")
    for _, child in pairs(backpack:GetChildren()) do
        if child:IsA("Tool") then ConnectTool(child) end
    end
    table.insert(RainbowGun.Connections, backpack.ChildAdded:Connect(function(c)
        if c:IsA("Tool") then ConnectTool(c) end
    end))
end

local function ToggleRainbowGun(state)
    RainbowGun.Enabled = state
    if state then
        game.StarterGui:SetCore("SendNotification", {Title="‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∑‡∏ô‡∏™‡∏≤‡∏¢‡∏£‡∏∏‡πâ‡∏á", Text="‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏µ‡∏£‡∏∏‡πâ‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß", Duration=6})
        if not RainbowGun.Loop then
            RainbowGun.Loop = RunService.Heartbeat:Connect(UpdateRainbowGun)
        end
        if LocalPlayer.Character then SetupGun(LocalPlayer.Character) end
    else
        game.StarterGui:SetCore("SendNotification", {Title="‡∏õ‡∏¥‡∏î‡∏õ‡∏∑‡∏ô‡∏™‡∏≤‡∏¢‡∏£‡∏∏‡πâ‡∏á", Text="‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏µ‡∏£‡∏∏‡πâ‡∏á‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß", Duration=4})
        if RainbowGun.Loop then RainbowGun.Loop:Disconnect() RainbowGun.Loop = nil end
        if RainbowGun.Highlight then RainbowGun.Highlight:Destroy() RainbowGun.Highlight = nil end
        RainbowGun.Current = nil
    end
end

LocalPlayer.CharacterAdded:Connect(SetupGun)
if LocalPlayer.Character then SetupGun(LocalPlayer.Character) end

--// ============================================== --
--//                  GUI CONTROLS                 --
--// ============================================== --

--// ESP Tab (‡πÉ‡∏ä‡πâ AimbotTab ‡∏ï‡πà‡∏≠)
AimbotTab:CreateSection("___üëÅÔ∏è ESP Visual______________________________________")

AimbotTab:CreateToggle({
    Name = "[ üîç ]  ‡πÄ‡∏õ‡∏¥‡∏î ESP (‡∏Å‡∏•‡πà‡∏≠‡∏á + ‡∏ä‡∏∑‡πà‡∏≠)",
    CurrentValue = false,
    Callback = function(v) ESP.Enabled = v end
})

AimbotTab:CreateToggle({
    Name = "[ üîç ]  ‡πÄ‡∏õ‡∏¥‡∏î Tracer ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
    CurrentValue = true,
    Callback = function(v) ESP.Tracer = v end
})

--// Rainbow Gun Tab
RainbowTab:CreateSection("___üè≥Ô∏è‚Äçüåà Rainbow Gun______________________________________")

RainbowTab:CreateToggle({
    Name = "[ üåà ]  ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î ‡∏õ‡∏∑‡∏ô‡∏™‡∏µ‡∏™‡∏≤‡∏¢‡∏£‡∏∏‡πâ‡∏á",
    CurrentValue = false,
    Callback = function(v) ToggleRainbowGun(v) end
})

RainbowTab:CreateParagraph({
    Title = "‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ",
    Content = "‡∏ñ‡∏∑‡∏≠‡∏õ‡∏∑‡∏ô ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå ‚Üí ‡∏õ‡∏∑‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡∏™‡∏≤‡∏¢‡∏£‡∏∏‡πâ‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
})
